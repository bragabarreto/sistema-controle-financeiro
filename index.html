<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Controle Financeiro Completo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .sidebar-item:hover { background-color: #f3f4f6; }
        .sidebar-item.active { background-color: #2563eb; color: white; }
        .modal { backdrop-filter: blur(4px); }
        .category-chip { display: inline-block; padding: 4px 8px; border-radius: 12px; font-size: 12px; margin: 2px; }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Login Modal -->
    <div id="loginModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-2xl shadow-xl p-8 w-full max-w-md mx-4">
            <div class="text-center mb-8">
                <div class="mx-auto h-16 w-16 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-full flex items-center justify-center mb-4">
                    <span class="text-white text-2xl">üîí</span>
                </div>
                <h2 class="text-3xl font-bold text-gray-900">Sistema Financeiro</h2>
                <p class="text-gray-600 mt-2">Acesse sua conta para continuar</p>
            </div>
            
            <form id="loginForm" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Usu√°rio</label>
                    <input id="username" type="text" required 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                           placeholder="Digite seu usu√°rio">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Senha</label>
                    <input id="password" type="password" required 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                           placeholder="Digite sua senha">
                </div>
                
                <div id="errorMessage" class="hidden bg-red-50 border border-red-200 rounded-lg p-3">
                    <p class="text-sm text-red-700">Usu√°rio ou senha incorretos</p>
                </div>
                
                <button type="submit" class="w-full bg-gradient-to-r from-blue-600 to-indigo-600 text-white py-3 px-4 rounded-lg font-medium hover:from-blue-700 hover:to-indigo-700 transition-all">
                    Entrar
                </button>
            </form>
        </div>
    </div>

    <!-- Main App -->
    <div id="mainApp" class="hidden min-h-screen flex">
        <!-- Sidebar -->
        <div class="w-64 bg-white shadow-lg">
            <div class="p-6 border-b">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center">
                        <span class="text-white text-lg">üí∞</span>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold text-gray-900">FinanceControl</h1>
                        <p class="text-sm text-gray-500">Sistema Completo</p>
                    </div>
                </div>
            </div>
            
            <nav class="p-4">
                <div class="space-y-2">
                    <button onclick="showPage('dashboard')" class="sidebar-item w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-left transition-colors active">
                        <span class="text-xl">üè†</span>
                        <div>
                            <div class="font-medium">Dashboard</div>
                            <div class="text-xs opacity-75">Vis√£o geral das finan√ßas</div>
                        </div>
                    </button>
                    
                    <button onclick="showPage('transacoes')" class="sidebar-item w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-left transition-colors">
                        <span class="text-xl">üí≥</span>
                        <div>
                            <div class="font-medium">Transa√ß√µes</div>
                            <div class="text-xs opacity-75">Gastos e receitas</div>
                        </div>
                    </button>
                    
                    <button onclick="showPage('contas')" class="sidebar-item w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-left transition-colors">
                        <span class="text-xl">üè¶</span>
                        <div>
                            <div class="font-medium">Contas</div>
                            <div class="text-xs opacity-75">Bancos e cart√µes</div>
                        </div>
                    </button>
                    
                    <button onclick="showPage('investimentos')" class="sidebar-item w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-left transition-colors">
                        <span class="text-xl">üìà</span>
                        <div>
                            <div class="font-medium">Investimentos</div>
                            <div class="text-xs opacity-75">Aplica√ß√µes e metas</div>
                        </div>
                    </button>
                    
                    <button onclick="showPage('processamento')" class="sidebar-item w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-left transition-colors">
                        <span class="text-xl">ü§ñ</span>
                        <div>
                            <div class="font-medium">Processamento IA</div>
                            <div class="text-xs opacity-75">Documentos e OCR</div>
                        </div>
                    </button>
                    
                    <button onclick="showPage('relatorios')" class="sidebar-item w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-left transition-colors">
                        <span class="text-xl">üìä</span>
                        <div>
                            <div class="font-medium">Relat√≥rios</div>
                            <div class="text-xs opacity-75">Gr√°ficos e an√°lises</div>
                        </div>
                    </button>
                    
                    <button onclick="showPage('configuracoes')" class="sidebar-item w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-left transition-colors">
                        <span class="text-xl">‚öôÔ∏è</span>
                        <div>
                            <div class="font-medium">Configura√ß√µes</div>
                            <div class="text-xs opacity-75">Backup e sistema</div>
                        </div>
                    </button>
                </div>
            </nav>
        </div>

        <!-- Main Content -->
        <div class="flex-1">
            <!-- Header -->
            <header class="bg-white shadow-sm border-b px-6 py-4">
                <div class="flex justify-between items-center">
                    <h2 id="pageTitle" class="text-2xl font-bold text-gray-900">Dashboard</h2>
                    <div class="flex items-center space-x-4">
                        <span class="text-sm text-gray-600">Bem-vindo, <strong>bragabarreto</strong></span>
                        <button onclick="logout()" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors">
                            Sair
                        </button>
                    </div>
                </div>
            </header>

            <!-- Page Content -->
            <main class="p-6">
                <!-- Dashboard Page -->
                <div id="dashboardPage" class="page-content">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                        <div class="bg-white rounded-lg shadow p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600">Receitas</p>
                                    <p class="text-2xl font-bold text-green-600" id="totalReceitas">R$ 0,00</p>
                                </div>
                                <span class="text-3xl">üìà</span>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-lg shadow p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600">Gastos</p>
                                    <p class="text-2xl font-bold text-red-600" id="totalGastos">R$ 0,00</p>
                                </div>
                                <span class="text-3xl">üìâ</span>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-lg shadow p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600">Saldo</p>
                                    <p class="text-2xl font-bold text-blue-600" id="saldo">R$ 0,00</p>
                                </div>
                                <span class="text-3xl">üí∞</span>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-lg shadow p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600">Investimentos</p>
                                    <p class="text-2xl font-bold text-purple-600" id="totalInvestimentos">R$ 0,00</p>
                                </div>
                                <span class="text-3xl">üè¶</span>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                        <div class="bg-white rounded-lg shadow p-6">
                            <h3 class="text-lg font-semibold mb-4">Gastos por Categoria</h3>
                            <canvas id="gastosChart" width="400" height="200"></canvas>
                        </div>
                        
                        <div class="bg-white rounded-lg shadow p-6">
                            <h3 class="text-lg font-semibold mb-4">Evolu√ß√£o Mensal</h3>
                            <canvas id="evolucaoChart" width="400" height="200"></canvas>
                        </div>
                    </div>

                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4">Transa√ß√µes Recentes</h3>
                        <div id="transacoesRecentes" class="space-y-3">
                            <p class="text-gray-500 text-center py-8">Nenhuma transa√ß√£o encontrada.</p>
                        </div>
                    </div>
                </div>

                <!-- Transa√ß√µes Page -->
                <div id="transacoesPage" class="page-content hidden">
                    <div class="mb-6 flex gap-4">
                        <button onclick="showAddTransactionModal()" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                            + Nova Transa√ß√£o
                        </button>
                        <button onclick="showRecurrentModal()" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                            üîÑ Gastos Recorrentes
                        </button>
                        <button onclick="showInstallmentModal()" class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors">
                            üìÖ Parcelamentos
                        </button>
                    </div>

                    <div class="bg-white rounded-lg shadow">
                        <div class="p-6 border-b">
                            <div class="flex justify-between items-center">
                                <h3 class="text-lg font-semibold">Hist√≥rico de Transa√ß√µes</h3>
                                <div class="flex gap-2">
                                    <select id="filterCategory" class="px-3 py-1 border rounded-lg text-sm">
                                        <option value="">Todas as categorias</option>
                                    </select>
                                    <select id="filterType" class="px-3 py-1 border rounded-lg text-sm">
                                        <option value="">Todos os tipos</option>
                                        <option value="receita">Receitas</option>
                                        <option value="gasto">Gastos</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="p-6">
                            <div id="transacoesList" class="space-y-3">
                                <p class="text-gray-500 text-center py-8">Nenhuma transa√ß√£o encontrada.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Contas Page -->
                <div id="contasPage" class="page-content hidden">
                    <div class="mb-6">
                        <button onclick="showAddAccountModal()" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                            + Nova Conta
                        </button>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="contasList">
                        <!-- Contas ser√£o carregadas aqui -->
                    </div>
                </div>

                <!-- Investimentos Page -->
                <div id="investimentosPage" class="page-content hidden">
                    <div class="mb-6 flex gap-4">
                        <button onclick="showAddInvestmentModal()" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                            + Novo Investimento
                        </button>
                        <button onclick="showAddGoalModal()" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                            üéØ Nova Meta
                        </button>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-white rounded-lg shadow p-6">
                            <h3 class="text-lg font-semibold mb-4">Carteira de Investimentos</h3>
                            <div id="investmentsList" class="space-y-3">
                                <p class="text-gray-500 text-center py-8">Nenhum investimento encontrado.</p>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-lg shadow p-6">
                            <h3 class="text-lg font-semibold mb-4">Metas Financeiras</h3>
                            <div id="goalsList" class="space-y-3">
                                <p class="text-gray-500 text-center py-8">Nenhuma meta encontrada.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Processamento IA Page -->
                <div id="processamentoPage" class="page-content hidden">
                    <div class="mb-6">
                        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6">
                            <div class="flex items-center">
                                <span class="text-yellow-600 text-xl mr-3">‚ö†Ô∏è</span>
                                <div>
                                    <h4 class="font-medium text-yellow-800">Configure sua API Key</h4>
                                    <p class="text-sm text-yellow-700">V√° em Configura√ß√µes para adicionar suas chaves de API dos provedores de IA.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div class="bg-white rounded-lg shadow p-6 text-center">
                            <div class="text-4xl mb-4">üìÑ</div>
                            <h3 class="text-lg font-semibold mb-2">Contracheques</h3>
                            <p class="text-sm text-gray-600 mb-4">Extraia rubricas automaticamente</p>
                            <button onclick="showUploadModal('contracheque')" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                                Processar
                            </button>
                        </div>
                        
                        <div class="bg-white rounded-lg shadow p-6 text-center">
                            <div class="text-4xl mb-4">üè¶</div>
                            <h3 class="text-lg font-semibold mb-2">Extratos Banc√°rios</h3>
                            <p class="text-sm text-gray-600 mb-4">Importe transa√ß√µes automaticamente</p>
                            <button onclick="showUploadModal('extrato')" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                                Processar
                            </button>
                        </div>
                        
                        <div class="bg-white rounded-lg shadow p-6 text-center">
                            <div class="text-4xl mb-4">üí≥</div>
                            <h3 class="text-lg font-semibold mb-2">Faturas de Cart√£o</h3>
                            <p class="text-sm text-gray-600 mb-4">Identifique compras e parcelamentos</p>
                            <button onclick="showUploadModal('fatura')" class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors">
                                Processar
                            </button>
                        </div>
                    </div>

                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4">Hist√≥rico de Processamentos</h3>
                        <div id="processamentosHistory" class="space-y-3">
                            <p class="text-gray-500 text-center py-8">Nenhum processamento realizado.</p>
                        </div>
                    </div>
                </div>

                <!-- Relat√≥rios Page -->
                <div id="relatoriosPage" class="page-content hidden">
                    <div class="mb-6 flex gap-4">
                        <select id="reportPeriod" class="px-3 py-2 border rounded-lg">
                            <option value="month">Este m√™s</option>
                            <option value="quarter">√öltimos 3 meses</option>
                            <option value="year">Este ano</option>
                            <option value="all">Todos os per√≠odos</option>
                        </select>
                        <button onclick="generateReport()" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                            üìä Gerar Relat√≥rio
                        </button>
                        <button onclick="exportReport()" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                            üì• Exportar PDF
                        </button>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-white rounded-lg shadow p-6">
                            <h3 class="text-lg font-semibold mb-4">Distribui√ß√£o de Gastos</h3>
                            <canvas id="reportGastosChart" width="400" height="300"></canvas>
                        </div>
                        
                        <div class="bg-white rounded-lg shadow p-6">
                            <h3 class="text-lg font-semibold mb-4">Tend√™ncia Mensal</h3>
                            <canvas id="reportTendenciaChart" width="400" height="300"></canvas>
                        </div>
                    </div>

                    <div class="mt-6 bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4">Resumo Detalhado</h3>
                        <div id="reportSummary" class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <!-- Resumo ser√° carregado aqui -->
                        </div>
                    </div>
                </div>

                <!-- Configura√ß√µes Page -->
                <div id="configuracoesPage" class="page-content hidden">
                    <div class="space-y-6">
                        <!-- API Keys -->
                        <div class="bg-white rounded-lg shadow p-6">
                            <h3 class="text-lg font-semibold mb-4">ü§ñ Configura√ß√µes de IA</h3>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">OpenAI API Key</label>
                                    <input id="openaiKey" type="password" class="w-full px-3 py-2 border border-gray-300 rounded-lg" placeholder="sk-...">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Anthropic API Key</label>
                                    <input id="anthropicKey" type="password" class="w-full px-3 py-2 border border-gray-300 rounded-lg" placeholder="sk-ant-...">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Google Gemini API Key</label>
                                    <input id="geminiKey" type="password" class="w-full px-3 py-2 border border-gray-300 rounded-lg" placeholder="AI...">
                                </div>
                                <button onclick="saveApiKeys()" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                                    Salvar Chaves
                                </button>
                            </div>
                        </div>

                        <!-- Backup Local -->
                        <div class="bg-white rounded-lg shadow p-6">
                            <h3 class="text-lg font-semibold mb-4">üíæ Backup Local</h3>
                            <div class="space-y-4">
                                <div class="flex gap-4">
                                    <button onclick="exportData()" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                                        üì• Exportar Dados
                                    </button>
                                    <input type="file" id="importFile" accept=".json" onchange="importData()" class="hidden">
                                    <button onclick="document.getElementById('importFile').click()" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                                        üì§ Importar Dados
                                    </button>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Pasta de Backup</label>
                                    <div class="flex gap-2">
                                        <input id="backupFolder" type="text" readonly class="flex-1 px-3 py-2 border border-gray-300 rounded-lg bg-gray-50" value="Downloads/FinanceControl/">
                                        <button onclick="selectBackupFolder()" class="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors">
                                            üìÅ Selecionar
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Categorias -->
                        <div class="bg-white rounded-lg shadow p-6">
                            <h3 class="text-lg font-semibold mb-4">üè∑Ô∏è Categorias</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h4 class="font-medium mb-3">Categorias de Gastos</h4>
                                    <div id="gastosCategories" class="space-y-2">
                                        <!-- Categorias ser√£o carregadas aqui -->
                                    </div>
                                </div>
                                <div>
                                    <h4 class="font-medium mb-3">Categorias de Receitas</h4>
                                    <div id="receitasCategories" class="space-y-2">
                                        <!-- Categorias ser√£o carregadas aqui -->
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Estat√≠sticas -->
                        <div class="bg-white rounded-lg shadow p-6">
                            <h3 class="text-lg font-semibold mb-4">üìä Estat√≠sticas do Sistema</h3>
                            <div id="systemStats" class="grid grid-cols-2 md:grid-cols-4 gap-4">
                                <!-- Estat√≠sticas ser√£o carregadas aqui -->
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Modals ser√£o adicionados aqui via JavaScript -->
    <div id="modalsContainer"></div>

    <script>
        // Dados globais
        let transactions = JSON.parse(localStorage.getItem('financial-transactions') || '[]');
        let accounts = JSON.parse(localStorage.getItem('financial-accounts') || '[]');
        let investments = JSON.parse(localStorage.getItem('financial-investments') || '[]');
        let goals = JSON.parse(localStorage.getItem('financial-goals') || '[]');
        let recurrentTransactions = JSON.parse(localStorage.getItem('financial-recurrent') || '[]');
        let installments = JSON.parse(localStorage.getItem('financial-installments') || '[]');
        let processedDocuments = JSON.parse(localStorage.getItem('financial-processed') || '[]');
        let apiKeys = JSON.parse(localStorage.getItem('financial-api-keys') || '{}');
        let isAuthenticated = localStorage.getItem('financial-auth') === 'true';

        // Categorias pr√©-definidas
        const categories = {
            gastos: [
                { name: 'Alimenta√ß√£o', color: '#ef4444', icon: 'üçΩÔ∏è' },
                { name: 'Transporte', color: '#3b82f6', icon: 'üöó' },
                { name: 'Moradia', color: '#8b5cf6', icon: 'üè†' },
                { name: 'Sa√∫de', color: '#10b981', icon: 'üè•' },
                { name: 'Educa√ß√£o', color: '#f59e0b', icon: 'üìö' },
                { name: 'Lazer', color: '#ec4899', icon: 'üéÆ' },
                { name: 'Roupas', color: '#6366f1', icon: 'üëï' },
                { name: 'Beleza', color: '#84cc16', icon: 'üíÑ' },
                { name: 'Pets', color: '#f97316', icon: 'üêï' },
                { name: 'Impostos', color: '#64748b', icon: 'üìã' },
                { name: 'Seguros', color: '#0891b2', icon: 'üõ°Ô∏è' },
                { name: 'Investimentos', color: '#059669', icon: 'üìà' },
                { name: 'Doa√ß√µes', color: '#dc2626', icon: '‚ù§Ô∏è' },
                { name: 'Outros', color: '#6b7280', icon: 'üì¶' }
            ],
            receitas: [
                { name: 'Sal√°rio', color: '#10b981', icon: 'üíº' },
                { name: 'Freelance', color: '#3b82f6', icon: 'üíª' },
                { name: 'Investimentos', color: '#8b5cf6', icon: 'üìà' },
                { name: 'Aluguel', color: '#f59e0b', icon: 'üè†' },
                { name: 'Vendas', color: '#ef4444', icon: 'üõí' },
                { name: 'Pr√™mios', color: '#ec4899', icon: 'üèÜ' },
                { name: 'Restitui√ß√£o', color: '#6366f1', icon: 'üí∞' },
                { name: 'Pens√£o', color: '#84cc16', icon: 'üë®‚Äçüë©‚Äçüëß‚Äçüë¶' },
                { name: 'Benef√≠cios', color: '#f97316', icon: 'üéÅ' },
                { name: 'Consultoria', color: '#0891b2', icon: 'ü§ù' },
                { name: 'Royalties', color: '#059669', icon: 'üìö' },
                { name: 'Outros', color: '#6b7280', icon: 'üì¶' }
            ]
        };

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            if (isAuthenticated) {
                showMainApp();
            }
            loadCategories();
        });

        // Autentica√ß√£o
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (username === 'bragabarreto' && password === 'Mimilulu1719#') {
                localStorage.setItem('financial-auth', 'true');
                showMainApp();
            } else {
                document.getElementById('errorMessage').classList.remove('hidden');
            }
        });

        function logout() {
            localStorage.removeItem('financial-auth');
            document.getElementById('loginModal').classList.remove('hidden');
            document.getElementById('mainApp').classList.add('hidden');
        }

        function showMainApp() {
            document.getElementById('loginModal').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
            updateDashboard();
            loadApiKeys();
        }

        // Navega√ß√£o
        function showPage(pageId) {
            document.querySelectorAll('.page-content').forEach(page => {
                page.classList.add('hidden');
            });
            
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.classList.remove('active');
            });
            
            document.getElementById(pageId + 'Page').classList.remove('hidden');
            
            const titles = {
                'dashboard': 'Dashboard',
                'transacoes': 'Transa√ß√µes',
                'contas': 'Contas',
                'investimentos': 'Investimentos',
                'processamento': 'Processamento IA',
                'relatorios': 'Relat√≥rios',
                'configuracoes': 'Configura√ß√µes'
            };
            document.getElementById('pageTitle').textContent = titles[pageId];
            
            event.target.closest('.sidebar-item').classList.add('active');
            
            // Carregar conte√∫do espec√≠fico da p√°gina
            switch(pageId) {
                case 'dashboard':
                    updateDashboard();
                    break;
                case 'transacoes':
                    updateTransactionsList();
                    break;
                case 'contas':
                    updateAccountsList();
                    break;
                case 'investimentos':
                    updateInvestmentsList();
                    updateGoalsList();
                    break;
                case 'processamento':
                    updateProcessingHistory();
                    break;
                case 'relatorios':
                    generateReport();
                    break;
                case 'configuracoes':
                    updateSystemStats();
                    break;
            }
        }

        // Dashboard
        function updateDashboard() {
            const receitas = transactions.filter(t => t.type === 'receita').reduce((sum, t) => sum + t.value, 0);
            const gastos = transactions.filter(t => t.type === 'gasto').reduce((sum, t) => sum + t.value, 0);
            const saldo = receitas - gastos;
            const totalInvestimentos = investments.reduce((sum, i) => sum + i.currentValue, 0);

            document.getElementById('totalReceitas').textContent = formatCurrency(receitas);
            document.getElementById('totalGastos').textContent = formatCurrency(gastos);
            document.getElementById('saldo').textContent = formatCurrency(saldo);
            document.getElementById('totalInvestimentos').textContent = formatCurrency(totalInvestimentos);

            updateRecentTransactions();
            updateDashboardCharts();
        }

        function updateRecentTransactions() {
            const recent = transactions.slice(-5).reverse();
            const recentHtml = recent.length > 0 ? 
                recent.map(t => `
                    <div class="flex justify-between items-center p-3 border rounded-lg">
                        <div class="flex items-center space-x-3">
                            <span class="text-2xl">${getCategoryIcon(t.category)}</span>
                            <div>
                                <p class="font-medium">${t.description}</p>
                                <p class="text-sm text-gray-500">${t.category} ‚Ä¢ ${formatDate(t.date)}</p>
                            </div>
                        </div>
                        <p class="font-semibold ${t.type === 'receita' ? 'text-green-600' : 'text-red-600'}">
                            ${t.type === 'receita' ? '+' : '-'}${formatCurrency(Math.abs(t.value))}
                        </p>
                    </div>
                `).join('') :
                '<p class="text-gray-500 text-center py-8">Nenhuma transa√ß√£o encontrada.</p>';
            
            document.getElementById('transacoesRecentes').innerHTML = recentHtml;
        }

        function updateDashboardCharts() {
            // Gr√°fico de gastos por categoria
            const gastosCtx = document.getElementById('gastosChart').getContext('2d');
            const gastosPorCategoria = {};
            
            transactions.filter(t => t.type === 'gasto').forEach(t => {
                gastosPorCategoria[t.category] = (gastosPorCategoria[t.category] || 0) + t.value;
            });

            new Chart(gastosCtx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(gastosPorCategoria),
                    datasets: [{
                        data: Object.values(gastosPorCategoria),
                        backgroundColor: Object.keys(gastosPorCategoria).map(cat => getCategoryColor(cat))
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });

            // Gr√°fico de evolu√ß√£o mensal
            const evolucaoCtx = document.getElementById('evolucaoChart').getContext('2d');
            const monthlyData = getMonthlyData();

            new Chart(evolucaoCtx, {
                type: 'line',
                data: {
                    labels: monthlyData.labels,
                    datasets: [{
                        label: 'Receitas',
                        data: monthlyData.receitas,
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)'
                    }, {
                        label: 'Gastos',
                        data: monthlyData.gastos,
                        borderColor: '#ef4444',
                        backgroundColor: 'rgba(239, 68, 68, 0.1)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }

        // Fun√ß√µes auxiliares
        function formatCurrency(value) {
            return new Intl.NumberFormat('pt-BR', {
                style: 'currency',
                currency: 'BRL'
            }).format(value);
        }

        function formatDate(dateString) {
            return new Date(dateString + 'T00:00:00').toLocaleDateString('pt-BR');
        }

        function getCategoryIcon(categoryName) {
            const allCategories = [...categories.gastos, ...categories.receitas];
            const category = allCategories.find(c => c.name === categoryName);
            return category ? category.icon : 'üì¶';
        }

        function getCategoryColor(categoryName) {
            const allCategories = [...categories.gastos, ...categories.receitas];
            const category = allCategories.find(c => c.name === categoryName);
            return category ? category.color : '#6b7280';
        }

        function getMonthlyData() {
            const monthlyData = { labels: [], receitas: [], gastos: [] };
            const months = {};
            
            transactions.forEach(t => {
                const month = t.date.substring(0, 7);
                if (!months[month]) {
                    months[month] = { receitas: 0, gastos: 0 };
                }
                months[month][t.type === 'receita' ? 'receitas' : 'gastos'] += t.value;
            });

            Object.keys(months).sort().forEach(month => {
                monthlyData.labels.push(month);
                monthlyData.receitas.push(months[month].receitas);
                monthlyData.gastos.push(months[month].gastos);
            });

            return monthlyData;
        }

        // Carregar categorias
        function loadCategories() {
            const gastosSelect = document.getElementById('filterCategory');
            const gastosContainer = document.getElementById('gastosCategories');
            const receitasContainer = document.getElementById('receitasCategories');

            if (gastosSelect) {
                categories.gastos.forEach(cat => {
                    const option = document.createElement('option');
                    option.value = cat.name;
                    option.textContent = cat.name;
                    gastosSelect.appendChild(option);
                });

                categories.receitas.forEach(cat => {
                    const option = document.createElement('option');
                    option.value = cat.name;
                    option.textContent = cat.name;
                    gastosSelect.appendChild(option);
                });
            }

            if (gastosContainer) {
                gastosContainer.innerHTML = categories.gastos.map(cat => 
                    `<div class="category-chip" style="background-color: ${cat.color}20; color: ${cat.color}; border: 1px solid ${cat.color}40;">
                        ${cat.icon} ${cat.name}
                    </div>`
                ).join('');
            }

            if (receitasContainer) {
                receitasContainer.innerHTML = categories.receitas.map(cat => 
                    `<div class="category-chip" style="background-color: ${cat.color}20; color: ${cat.color}; border: 1px solid ${cat.color}40;">
                        ${cat.icon} ${cat.name}
                    </div>`
                ).join('');
            }
        }

        // Placeholder functions (implementa√ß√£o completa seria muito extensa)
        function showAddTransactionModal() { alert('Modal de transa√ß√£o seria implementado aqui'); }
        function showRecurrentModal() { alert('Modal de gastos recorrentes seria implementado aqui'); }
        function showInstallmentModal() { alert('Modal de parcelamentos seria implementado aqui'); }
        function showAddAccountModal() { alert('Modal de contas seria implementado aqui'); }
        function showAddInvestmentModal() { alert('Modal de investimentos seria implementado aqui'); }
        function showAddGoalModal() { alert('Modal de metas seria implementado aqui'); }
        function showUploadModal(type) { alert(`Modal de upload ${type} seria implementado aqui`); }
        function updateTransactionsList() { console.log('Atualizando lista de transa√ß√µes'); }
        function updateAccountsList() { console.log('Atualizando lista de contas'); }
        function updateInvestmentsList() { console.log('Atualizando lista de investimentos'); }
        function updateGoalsList() { console.log('Atualizando lista de metas'); }
        function updateProcessingHistory() { console.log('Atualizando hist√≥rico de processamentos'); }
        function generateReport() { console.log('Gerando relat√≥rio'); }
        function exportReport() { console.log('Exportando relat√≥rio'); }
        function saveApiKeys() { console.log('Salvando chaves API'); }
        function loadApiKeys() { console.log('Carregando chaves API'); }
        function exportData() { console.log('Exportando dados'); }
        function importData() { console.log('Importando dados'); }
        function selectBackupFolder() { console.log('Selecionando pasta de backup'); }
        function updateSystemStats() { console.log('Atualizando estat√≠sticas do sistema'); }
    </script>
</body>
</html>
